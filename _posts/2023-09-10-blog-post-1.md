---
title: 'TAPL - Operational Semantics'
date: 2023-09-09
permalink: /posts/2023/09/tapl-02
tags:
  - programming language
  - computer science
---

## Intro to semantics
什么是一个程序的语义？当我们写下一段代码，我们所写下的是一段字符序列，它是程序的语法表示。通过语法，我们只是表示了程序表面上看起来的样子，并没有指出它实际上的含义。举例来说，对于一段程序，在没有指明的情况下，在实现中可以有不同的语义。一个例子是 C 语言，对同一段代码，对于 C 语言中的所谓 undefined 的行为，不同的编译器实现，乃至在不同的硬件上，都可能有不同的结果。
因此，光从一段程序来看，如果没有这个语言的语义描述的手册或者规约之类的东西，我们无法判断它的语义。一个很自然的想法是，当我们在机器上执行一段程序，执行之后产生的影响就是这段程序的语义。然而，这种定义实际上有很大的问题，当我们提到在机器上执行一段程序，实际上已经和实现相关，这可能和编译器或者解释器的实现有关，而要严格地实现某个语言的编译器或者解释器，实际上需要先知道这个语言的语义规则，否则，不同的人实现出来的对于同一个语言的编译器或者解释器执行同一段程序产生的效果却不同，这是不可接受的。
在一些语言的手册中可能会有关于语义的描述，但是通常是不严格的描述，以例子的形式给出。这是由于以现有的方法通过严格的方式描述现实生产中的语言通常是非常繁琐或非常抽象的，再者说来，这对于不了解相关理论的开发者也是无法阅读的。

然而，严格的形式化地描述程序语言的语义的工具仍然是十分有意义的，相比于非形式化的表述，形式化地描述程序语言的语义有以下的几个好处:
- Less ambiguous: 程序的行为对于人来说将更加清晰，这对于语言的某个 feature 的实现者，使用这个语言的开发者，和实现这个语言的工具链（比如编译器）的开发者都是有意义的。
- More concise: 对于某些语言特性的描述，通过数学语言来描述常常比自然语言更加准确。
- Formal argument: 通过形式化地描述，能够让我们下某种断言。比如，我们可以指出，并证明，对于所有输入，某个语言的程序不会产生某个类型的运行时错误。

目前用来形式化地表述程序语言的语义的方法主要有三种: 
- operational semantcis: 通过描述程序如何在一个 abstract machine 上执行来指明语义。
- denotational semantics: 通过数学上的函数来建模程序来指明语义。
- axiomatic semantics: 通过在程序执行前后需要满足的某些逻辑式来定义程序的行为。

不同的方法在不同的场景中各有优劣，但是在 TAPL 中将主要使用 operational semantics.

## Syntax of an Example Language
为了阐述之用，需要有一个简单的小语言，在这里使用一个只有整数表达式和赋值语句的简单语言，在这个小节简单描述其语法。在这个语言中，一段程序就是一个表达式，执行这个程序意味着对一个表达式求值产生一个整数。
为了描述这个语言，我们会使用以下几个 domain:
- $x, y, z \in Var$
- $n, m \in Int$
- $e \in Exp$

我们可以通过 BNF 范式来描述这个语言的 grammar: $e::= x | n | e_1 + e_2 | e_1 \times e_2 | x := e_1;e_2$

其中，不严格地说，这里的赋值语句更像是某些语言中的 let in 语句，先求值表达式 $e_1$ 绑定到 $x$，再求值 $e_2$，最后整个表达式的值是 $e_2$ 的值。

这里的文法实际上是有二义性的，还需要考虑乘号和加号的优先级的关系，我们可以通过一些办法消除二义性，但是这样会使得文法更加复杂。或者我们可以加上括号，但是这样写起来比较麻烦，因此在之后的讨论中假设我们已经得到了抽象语法树，这样就不需要考虑这些和语义无关的细节，这里的文法描述仅供直观理解之用。

## Abstract Machine

## Small Step Operational Semantics

## Big Step Operational Semantics
